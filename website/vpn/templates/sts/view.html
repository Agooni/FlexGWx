{% extends "layout.html" %}
{% block title %} VPN Site-to-Site 修改隧道{% endblock %}

{% block trail %}
        <li><a href="/">Home</a></li>
        <li><a href="{{ url_for('vpn.index') }}">VPN</a></li>
        <li class="current"><a href="{{ url_for('vpn.sts_index') }}">Site-to-Site</a></li>
{% endblock trail %}

{% block content %}
    <!-- start of side-nav -->
    <div id="side-nav" class="large-2 columns">
      <ul class="side-nav">
        <li><a href="{{ url_for('vpn.sts_index') }}"><i class="fi-list"> </i>隧道列表</a></li>
        <li><a href="{{ url_for('vpn.sts_add') }}"><i class="fi-plus"> </i>新增隧道</a></li>
        <li><a href="{{ url_for('vpn.console') }}"><i class="fi-wrench"> </i>VPN 服务管理</a></li>
        <li class="active"><a href="{{ url_for('vpn.sts_settings', id=tunnel.id) }}"><i class="fi-pencil"> </i>修改</a></li>
      </ul>
    </div>
    <!-- end of side-nav -->

    <!-- start of sts vpn table -->
    <div class="large-10 columns">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      {% for category, message in messages %}
      <div data-alert class="alert-box {{ category }}">
        {{ message }}
        <a href="#" class="close">&times;</a>
      </div>
      {% endfor %}
      {% endif %}
      {% endwith %}
      <form method="POST" action="{{ url_for('vpn.sts_settings', id=tunnel.id) }}">
        <div class="row">
          <div class="large-3 columns">
            {{ form.tunnel_name.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {% if form.tunnel_name.errors %}
            {{ form.tunnel_name(class="error", value=form.tunnel_name.value) }}
            <small class="error">{{ form.tunnel_name.errors[0] }}</small>
            {% else %}
            {{ form.tunnel_name(value=tunnel.name) }}
            {% endif %}
          </div>
        </div>
        <div class="row">
          <div class="large-3 columns">
            {{ form.start_type.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {{ form.start_type }}
          </div>
        </div>
        <div class="row">
          <div class="large-3 columns">
            {{ form.protocol_type.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {{ form.protocol_type }}
          </div>
        </div>
        <div class="row">
          <div class="large-3 columns">
            {{ form.local_ip.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {% if form.local_ip.errors %}
            {{ form.local_ip(class="error", value=form.local_ip.value) }}
            <small class="error">{{ form.local_ip.errors[0] }}</small>
            {% else %}
            {{ form.local_ip(value=tunnel.rules.left) }}
            {% endif %}
          </div>
        </div>
        <div class="row">
          <div class="large-3 columns">
            {{ form.local_subnet.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {% if form.local_subnet.errors %}
            {{ form.local_subnet(class="error", value=form.local_subnet.value) }}
            <small class="error">{{ form.local_subnet.errors[0] }}</small>
            {% else %}
            {{ form.local_subnet(value=tunnel.rules.leftsubnet) }}
            {% endif %}
          </div>
        </div>
        <div class="row">
          <div class="large-3 columns">
            {{ form.remote_ip.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {% if form.remote_ip.errors %}
            {{ form.remote_ip(class="error", value=form.remote_ip.value) }}
            <small class="error">{{ form.remote_ip.errors[0] }}</small>
            {% else %}
            {{ form.remote_ip(value=tunnel.rules.right) }}
            {% endif %}
          </div>
        </div>
        <div class="row">
          <div class="large-3 columns">
            {{ form.remote_subnet.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {% if form.remote_subnet.errors %}
            {{ form.remote_subnet(class="error", value=form.remote_subnet.value) }}
            <small class="error">{{ form.remote_subnet.errors[0] }}</small>
            {% else %}
            {{ form.remote_subnet }}
            {% endif %}
          </div>
        </div>
        <div class="row">
          <div class="large-3 columns">
            {{ form.psk.label(class="right inline") }}
          </div>
          <div class="large-5 columns end">
            {% if form.psk.errors %}
            {{ form.psk(class="error", value=form.psk.value) }}
            <small class="error">{{ form.psk.errors[0] }}</small>
            {% else %}
            {{ form.psk(value=tunnel.psk) }}
            {% endif %}
          </div>
        </div>

        <div class="row">
          <div class="large-3 columns large-offset-3">
            {{ form.save(class="success tiny button") }}
          </div>
          <div class="large-2 columns end">
            {{ form.delete(class="alert tiny button") }}
          </div>
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
        </div>
      </form>
    </div>
    <!-- end of sts vpn table -->
{% endblock content %}
